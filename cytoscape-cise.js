!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("avsdf-base"),require("cose-base")):"function"==typeof define&&define.amd?define(["avsdf-base","cose-base"],t):"object"==typeof exports?exports.cytoscapeCise=t(require("avsdf-base"),require("cose-base")):e.cytoscapeCise=t(e.avsdfBase,e.coseBase)}(this,function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=14)}([function(t,n){t.exports=e},function(e,t,n){"use strict";function i(){}var r=n(0).layoutBase.FDLayoutConstants;for(var o in r)i[o]=r[o];i.DEFAULT_SPRING_STRENGTH=1.5*r.DEFAULT_SPRING_STRENGTH,i.DEFAULT_NODE_SEPARATION=r.DEFAULT_EDGE_LENGTH/4,i.DEFAULT_IDEAL_INTER_CLUSTER_EDGE_LENGTH_COEFF=1.4,i.DEFAULT_ALLOW_NODES_INSIDE_CIRCLE=!1,i.DEFAULT_MAX_RATIO_OF_NODES_INSIDE_CIRCLE=.1,i.DEFAULT_INNER_EDGE_LENGTH=r.DEFAULT_EDGE_LENGTH/3,i.MAX_ROTATION_ANGLE=Math.PI/36,i.MIN_ROTATION_ANGLE=-i.MAX_ROTATION_ANGLE,i.SWAP_IDLE_DURATION=45,i.SWAP_PREPERATION_DURATION=5,i.SWAP_PERIOD=i.SWAP_IDLE_DURATION+i.SWAP_PREPERATION_DURATION,i.SWAP_HISTORY_CLEARANCE_PERIOD=6*i.SWAP_PERIOD,i.MIN_DISPLACEMENT_FOR_SWAP=6,i.REVERSE_PERIOD=25,e.exports=i},function(e,t,n){"use strict";e.exports=null!=Object.assign?Object.assign.bind(Object):function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.forEach(function(t){Object.keys(t).forEach(function(n){return e[n]=t[n]})}),e}},function(e,t,n){"use strict";e.exports=n(15)},function(e,t,n){"use strict";function i(e,t,n){r.call(this,e,t,n),this.intraClusterEdges=null,this.interClusterEdges=null,this.inNodes=[],this.outNodes=[],this.onCircleNodes=[],this.inCircleNodes=[],this.additionalNodeSeparation=null,this.radius=0,this.orderMatrix=null,this.mayBeReversed=!0}var r=n(0).layoutBase.LGraph,o=n(0).layoutBase.IGeometry,s=n(0).layoutBase.NeedlemanWunsch,a=n(13),d=n(1),l=n(7),c=n(8);i.prototype=Object.create(r.prototype);for(var g in r)i[g]=r[g];i.prototype.setRadius=function(e){this.radius=e},i.prototype.getRadius=function(){return this.radius},i.prototype.setAdditionalNodeSeparation=function(e){this.additionalNodeSeparation=e},i.prototype.getAdditionalNodeSeparation=function(){return null===this.additionalNodeSeparation&&this.setAdditionalNodeSeparation(0),this.additionalNodeSeparation},i.prototype.getInNodes=function(){return this.inNodes},i.prototype.getOutNodes=function(){return this.outNodes},i.prototype.getOnCircleNodes=function(){return this.onCircleNodes},i.prototype.getInCircleNodes=function(){return this.inCircleNodes},i.prototype.setMayNotBeReversed=function(){this.mayBeReversed=!1},i.prototype.getMayBeReversed=function(){return this.mayBeReversed},i.prototype.getChildAt=function(e){return this.onCircleNodes[e]},i.prototype.getInterClusterEdges=function(){var e=this;return null===this.interClusterEdges&&(this.interClusterEdges=[],this.outNodes.forEach(function(t){for(var n=t.getOnCircleNodeExt().getInterClusterEdges(),i=0;i<n.length;i++)e.interClusterEdges.push(n[i])})),this.interClusterEdges},i.prototype.getIntraClusterEdges=function(){var e=this;if(null===this.intraClusterEdges){this.intraClusterEdges=[];this.getEdges().forEach(function(t){t.isIntraEdge()&&e.intraClusterEdges.push(t)})}return this.intraClusterEdges},i.prototype.calculateParentNodeDimension=function(){for(var e=this,t=Number.MIN_SAFE_INTEGER,n=0;n<this.onCircleNodes.length;n++){var i=this.onCircleNodes[n];i.getWidth()>t&&(t=i.getWidth()),i.getHeight()>t&&(t=i.getHeight())}var r=2*(e.radius+e.margin)+t,o=e.getParent();o.setHeight(r),o.setWidth(r)},i.prototype.computeOrderMatrix=function(){var e=this.onCircleNodes.length;this.orderMatrix=new Array(e);for(var t=0;t<this.orderMatrix.length;t++)this.orderMatrix[t]=new Array(e);for(var n=0;n<e;n++)for(var i=0;i<e;i++)if(i>n){var r=this.onCircleNodes[i].getOnCircleNodeExt().getAngle()-this.onCircleNodes[n].getOnCircleNodeExt().getAngle();r<0&&(r+=o.TWO_PI),r<=Math.PI?(this.orderMatrix[n][i]=!0,this.orderMatrix[i][n]=!1):(this.orderMatrix[n][i]=!1,this.orderMatrix[i][n]=!0)}},i.prototype.rotate=function(){var e=this.getParent(),t=this.getOnCircleNodes().length,n=e.rotationAmount/t,i=this.getGraphManager().getLayout();if(0!==n){var r=n/this.radius;r>d.MAX_ROTATION_ANGLE?r=d.MAX_ROTATION_ANGLE:r<d.MIN_ROTATION_ANGLE&&(r=d.MIN_ROTATION_ANGLE);for(var o=0;o<t;o++){var s=this.getChildAt(o),a=s.getOnCircleNodeExt();a.setAngle(a.getAngle()+r),a.updatePosition()}i.totalDisplacement+=e.rotationAmount,e.rotationAmount=0}},i.prototype.getOrder=function(e,t){return this.orderMatrix[e.getOnCircleNodeExt().getIndex()][t.getOnCircleNodeExt().getIndex()]},i.prototype.getThisEnd=function(e){var t=e.getSource(),n=e.getTarget();return t.getOwner()===this?t:n},i.prototype.getOtherEnd=function(e){var t=e.getSource(),n=e.getTarget();return t.getOwner()===this?n:t},i.prototype.decomposeForce=function(e){var t=void 0;if(0!==e.displacementX||0!==e.displacementY){var n=this.getParent(),i=n.getCenterX(),r=n.getCenterY(),s=e.getCenterX(),d=e.getCenterY(),l=e.displacementX,c=e.displacementY,g=o.angleOfVector(i,r,s,d),h=o.angleOfVector(0,0,l,c),u=g+Math.PI,p=void 0;Math.PI<=u&&u<o.TWO_PI?p=g<=h&&h<u:(u-=o.TWO_PI,p=!(u<=h&&h<g));var f=Math.abs(g-h),N=Math.sqrt(l*l+c*c),E=Math.abs(Math.sin(f)*N);p||(E=-E),t=new a(E,l,c)}else t=new a(0,0,0);return t},i.prototype.swapNodes=function(e,t){var n=e,i=t,r=e.getOnCircleNodeExt(),o=t.getOnCircleNodeExt();if(n.getOnCircleNodeExt().getIndex()>t.getOnCircleNodeExt().getIndex()&&(n=t,i=e),n.getOnCircleNodeExt().getPrevNode()===i){var s=i;i=n,n=s}var a=n.getOnCircleNodeExt(),d=i.getOnCircleNodeExt(),l=a.getPrevNode(),c=this.getGraphManager().getLayout(),g=c.getNodeSeparation()+this.getAdditionalNodeSeparation(),h=(l.getOnCircleNodeExt().getAngle()+(l.getHalfTheDiagonal()+i.getHalfTheDiagonal()+g)/this.radius)%(2*Math.PI);d.setAngle(h),h=(d.getAngle()+(i.getHalfTheDiagonal()+n.getHalfTheDiagonal()+g)/this.radius)%(2*Math.PI),a.setAngle(h),a.updatePosition(),d.updatePosition();var u=r.getIndex();r.setIndex(o.getIndex()),o.setIndex(u),this.getOnCircleNodes()[r.getIndex()]=e,this.getOnCircleNodes()[o.getIndex()]=t,r.updateSwappingConditions(),o.updateSwappingConditions(),r.getNextNode()===t?(r.getPrevNode().getOnCircleNodeExt().updateSwappingConditions(),o.getNextNode().getOnCircleNodeExt().updateSwappingConditions()):(r.getNextNode().getOnCircleNodeExt().updateSwappingConditions(),o.getPrevNode().getOnCircleNodeExt().updateSwappingConditions())},i.prototype.checkAndReverseIfReverseIsBetter=function(){for(var e=this.getInterClusterEdges(),t=new Array(e.length),n=void 0,i=this.getParent().getCenter(),r=void 0,s=void 0,a=void 0,d=void 0,g=this.onCircleNodes.length,h=new Array(g),u=0;u<g;u++)h[u]=0;for(var p=0,f=0;f<e.length;f++)r=e[f],a=this.getOtherEnd(r),d=a.getCenter(),n=o.angleOfVector(i.x,i.y,d.x,d.y),t[f]=new l(r,n),s=this.getThisEnd(r),++h[s.getOnCircleNodeExt().getIndex()]>1&&p++;for(var N=this.onCircleNodes,E=g+p,v=new Array(2*E),C=new Array(2*E),y=void 0,I=-1,O=0;O<g;O++){y=N[O],0===h[O]&&(h[O]=1);for(var x=0;x<h[O];x++)I++,v[I]=v[E+I]=C[E-1-I]=C[2*E-1-I]=y.getOnCircleNodeExt().getCharCode()}for(var _=(new c(this,t),new Array(t.length)),S=0;S<t.length;S++)r=t[S].getEdge(),s=this.getThisEnd(r),_[S]=s.getOnCircleNodeExt().getCharCode();var m=this.computeAlignmentScore(v,_);if(-1!==m){var A=this.computeAlignmentScore(C,_);if(-1!==A&&A>m)return this.reverseNodes(),this.setMayNotBeReversed(),!0}return!1},i.prototype.computeAlignmentScore=function(e,t){return new s(e,t,20,-1,-2).getScore()},i.prototype.reverseNodes=function(){for(var e=this.getOnCircleNodes(),t=this.getOnCircleNodes().length,n=0;n<t;n++){var i=e[n],r=i.getOnCircleNodeExt();r.setIndex((t-r.getIndex())%t)}this.reCalculateNodeAnglesAndPositions()},i.prototype.moveOnCircleNodeInside=function(e){var t=this.onCircleNodes.indexOf(e);t>-1&&this.onCircleNodes.splice(t,1),this.inCircleNodes.push(e);for(var n=0;n<this.onCircleNodes.length;n++){this.onCircleNodes[n].getOnCircleNodeExt().setIndex(n)}e.setAsNonOnCircleNode(),this.reCalculateCircleSizeAndRadius(),this.reCalculateNodeAnglesAndPositions(),e.setCenter(this.getParent().getCenterX(),this.getParent().getCenterY())},i.prototype.reCalculateCircleSizeAndRadius=function(){for(var e=0,t=this.getOnCircleNodes(),n=0;n<t.length;n++){var i=t[n],r=i.getWidth()*i.getWidth()+i.getHeight()*i.getHeight();e+=Math.sqrt(r)}var o=this.getGraphManager().getLayout(),s=o.getNodeSeparation(),a=e+this.getOnCircleNodes().length*s;this.radius=a/(2*Math.PI),this.calculateParentNodeDimension()},i.prototype.reCalculateNodeAnglesAndPositions=function(){var e=this.getGraphManager().getLayout(),t=e.getNodeSeparation()+this.getAdditionalNodeSeparation(),n=this.onCircleNodes;n.sort(function(e,t){return e.getOnCircleNodeExt().getIndex()-t.getOnCircleNodeExt().getIndex()});for(var i=this.getParent().getCenterX(),r=this.getParent().getCenterY(),o=0;o<n.length;o++){var s=n[o],a=void 0;if(0===o)a=0;else{var d=n[o-1];a=d.getOnCircleNodeExt().getAngle()+(s.getHalfTheDiagonal()+t+d.getHalfTheDiagonal())/this.radius}s.getOnCircleNodeExt().setAngle(a),s.setCenter(i+this.radius*Math.cos(a),r+this.radius*Math.sin(a))}},e.exports=i},function(e,t,n){"use strict";function i(e,t,n){r.call(this,e,t,n),this.isIntraCluster=!0}var r=n(0).layoutBase.FDLayoutEdge;i.prototype=Object.create(r.prototype);for(var o in r)i[o]=r[o];i.prototype.isIntraEdge=function(){return this.isIntraCluster},i.prototype.crossesWithEdge=function(e){var t=!1,n=this.getSource().getOnCircleNodeExt(),i=this.getTarget().getOnCircleNodeExt(),r=e.getSource().getOnCircleNodeExt(),o=e.getTarget().getOnCircleNodeExt(),s=-1,a=-1,d=-1,l=-1;if(null!==n&&(s=n.getIndex()),null!==i&&(a=i.getIndex()),null!==r&&(d=r.getIndex()),null!==o&&(l=o.getIndex()),this.isInterGraph||e.isInterGraph)t=!0;else if(this.source.getOwner()!==this.target.getOwner())t=!1;else{-1!==s&&-1!==a&&-1!==d&&-1!==l||(t=!1);var c=r.getCircDistWithTheNode(n),g=o.getCircDistWithTheNode(n),h=i.getCircDistWithTheNode(n);h<Math.max(c,g)&&h>Math.min(c,g)&&0!==g&&0!==c&&(t=!0)}return t},i.prototype.calculateTotalCrossingWithList=function(e){for(var t=0,n=0;n<e.length;n++)t+=this.crossingWithEdge(e[n]);return t},i.prototype.crossingWithEdge=function(e){var t=this.crossesWithEdge(e),n=0;return t&&(n=1),n},e.exports=i},function(e,t,n){"use strict";function i(e){r.call(this,e),this.onCircleNodes=[],this.inCircleNodes=[],this.nonOnCircleNodes=[]}var r=n(0).layoutBase.LGraphManager;i.prototype=Object.create(r.prototype);for(var o in r)i[o]=r[o];i.prototype.getOnCircleNodes=function(){return this.onCircleNodes},i.prototype.getInCircleNodes=function(){return this.inCircleNodes},i.prototype.getNonOnCircleNodes=function(){return this.nonOnCircleNodes},i.prototype.setOnCircleNodes=function(e){this.onCircleNodes=e},i.prototype.setInCircleNodes=function(e){this.inCircleNodes=e},i.prototype.setNonOnCircleNodes=function(e){this.nonOnCircleNodes=e},e.exports=i},function(e,t,n){"use strict";function i(e,t){this.edge=e,this.angle=t}i.prototype=Object.create(null),i.prototype.getEdge=function(){return this.edge},i.prototype.getAngle=function(){return this.angle},e.exports=i},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n){i(this,e),this.ownerCircle=t,this._quicksort(n,0,n.length-1)}return r(e,[{key:"compareFunction",value:function(e,t){return t.getAngle()>e.getAngle()||t.getAngle()===e.getAngle()&&(e!==t&&this.ownerCircle.getOrder(this.ownerCircle.getThisEnd(e.getEdge()),this.ownerCircle.getThisEnd(t.getEdge())))}},{key:"_quicksort",value:function(e,t,n){if(t<n){var i=this._partition(e,t,n);this._quicksort(e,t,i),this._quicksort(e,i+1,n)}}},{key:"_partition",value:function(e,t,n){for(var i=this._get(e,t),r=t,o=n;;){for(;this.compareFunction(i,this._get(e,o));)o--;for(;this.compareFunction(this._get(e,r),i);)r++;if(!(r<o))return o;this._swap(e,r,o),r++,o--}}},{key:"_get",value:function(e,t){return e[t]}},{key:"_set",value:function(e,t,n){e[t]=n}},{key:"_swap",value:function(e,t,n){var i=this._get(e,t);this._set(e,t,this._get(e,n)),this._set(e,n,i)}}]),e}();e.exports=o},function(e,t,n){"use strict";function i(){r.call(this),this.incremental=g.INCREMENTAL,this.nodeSeparation=g.DEFAULT_NODE_SEPARATION,this.idealInterClusterEdgeLengthCoefficient=g.DEFAULT_IDEAL_INTER_CLUSTER_EDGE_LENGTH_COEFF,this.allowNodesInsideCircle=g.DEFAULT_ALLOW_NODES_INSIDE_CIRCLE,this.maxRatioOfNodesInsideCircle=g.DEFAULT_MAX_RATIO_OF_NODES_INSIDE_CIRCLE,this.step=i.STEP_NOT_STARTED,this.phase=i.PHASE_NOT_STARTED,this.swappedPairsInLastIteration=[],this.iterations=0,this.oldTotalDisplacement=0,this.coolingCycle=0,this.maxCoolingCycle=this.maxIterations/g.CONVERGENCE_CHECK_PERIOD}var r=n(0).layoutBase.FDLayout,o=n(0).layoutBase.HashMap,s=n(0).layoutBase.PointD,a=n(0).layoutBase.DimensionD,d=n(0).AVSDFConstants,l=n(0).AVSDFLayout,c=n(21).CoSELayout,g=n(1),h=n(6),u=n(4),p=n(10),f=n(5),N=n(12);i.prototype=Object.create(r.prototype);for(var E in r)i[E]=r[E];i.STEP_NOT_STARTED=0,i.STEP_1=1,i.STEP_2=2,i.STEP_3=3,i.STEP_4=4,i.STEP_5=5,i.PHASE_NOT_STARTED=0,i.PHASE_SWAP_PREPERATION=1,i.PHASE_PERFORM_SWAP=2,i.PHASE_OTHER=3,i.prototype.newGraphManager=function(){return this.graphManager=new h(this),this.graphManager},i.prototype.newCircleLGraph=function(e){return new u(null,this.graphManager,e)},i.prototype.newNode=function(e,t){return new p(this.graphManager,e,t,null)},i.prototype.newCiSEOnCircleNode=function(e,t){var n=this.newNode(e,t);return n.setAsOnCircleNode(),n},i.prototype.newEdge=function(e,t,n){return new f(e,t,n)},i.prototype.getNodeSeparation=function(){return this.nodeSeparation},i.prototype.convertToClusteredGraph=function(e,t,n){for(var i=this,r=this,d={},l=this.graphManager.getRoot(),c=new o,g=0;g<e.length;g++)c.put(e[g].data("id"),e[g]);if("function"==typeof n){for(var h=[],u=[],p=0;p<e.length;p++){var f=n(e[p]);if(f>0&&null!==f&&void 0!==f){var N=h.indexOf(f);N>-1?u[N].push(e[p].data("id")):(h.push(f),u.push([e[p].data("id")]))}}n=u}for(var E=0;E<n.length;E++){(function(e){if(0===n[e].length)return"continue";var t=i.newNode(null);t.setClusterId(e),l.add(t);var o=i.newCircleLGraph(null);i.graphManager.add(o,t),o.margin=o.margin+15,n[e].forEach(function(t){var n=c.get(t),i=n.layoutDimensions({nodeDimensionsIncludeLabels:!1}),l=r.newCiSEOnCircleNode(new s(n.position("x")-i.w/2,n.position("y")-i.h/2),new a(parseFloat(i.w),parseFloat(i.h)));l.setId(t),l.setClusterId(e),o.getOnCircleNodes().push(l),o.add(l),o.getInNodes().push(l),d[l.getId()]=l})})(E)}for(var v=0;v<e.length;v++)!function(t){var r=!1;if(n.forEach(function(n){n.includes(e[t].data("id"))&&(r=!0)}),!r){var o=e[t],c=o.layoutDimensions({nodeDimensionsIncludeLabels:!1}),g=i.newNode(new s(o.position("x")-c.w/2,o.position("y")-c.h/2),new a(parseFloat(c.w),parseFloat(c.h)));g.setClusterId(-1),g.setId(e[t].data("id")),l.add(g),d[g.getId()]=g}}(v);for(var C=0;C<t.length;C++){var y=t[C],I=d[y.data("source")],O=d[y.data("target")],x=I.getClusterId(),_=O.getClusterId();if(I!==O){var S=r.newEdge(I,O,null);x===_&&-1!==x&&-1!==_?(S.isIntraCluster=!0,S.getSource().getOwner().add(S,S.getSource(),S.getTarget())):(S.isIntraCluster=!1,this.graphManager.add(S,S.getSource(),S.getTarget()))}}for(var m=[],A=[],T=this.graphManager.getAllNodes(),R=0;R<T.length;R++)T[R].getOnCircleNodeExt()?m.push(T[R]):A.push(T[R]);return this.graphManager.setOnCircleNodes(m),this.graphManager.setNonOnCircleNodes(A),this.graphManager.edges.forEach(function(e){var t=e.getSource(),n=e.getTarget(),i=t.getClusterId(),r=n.getClusterId();if(-1!==i){var o=t.getOwner(),s=o.getInNodes().indexOf(t);s>-1&&(o.getInNodes().splice(s,1),o.getOutNodes().push(t))}if(-1!==r){var a=n.getOwner(),d=a.getInNodes().indexOf(n);d>-1&&(a.getInNodes().splice(d,1),a.getOutNodes().push(n))}}),d},i.prototype.doStep1=function(e){this.step=i.STEP_1,this.phase=i.PHASE_OTHER;for(var t=new o,n=this.graphManager.getGraphs(),r=0;r<n.length;r++){var s=n[r];if(s instanceof u){d.DEFAULT_NODE_SEPARATION=this.nodeSeparation;for(var a=new l,c=a.graphManager.addRoot(),g=s.getOnCircleNodes(),h=0,p=0,f=0;f<g.length;f++){var N=g[f],E=a.newNode(null),v=N.getLocation();E.setLocation(v.x,v.y),E.setWidth(N.getWidth()),E.setHeight(N.getHeight()),c.add(E),h+=v.x,p+=v.y,t.put(N,E)}h/=g.length,p/=g.length;for(var C=this.getAllEdges(),y=0;y<C.length;y++){var I=C[y];if(g.includes(I.getSource())&&g.includes(I.getTarget())){var O=t.get(I.getSource()),x=t.get(I.getTarget()),_=a.newEdge("");c.add(_,O,x)}}e&&(a.incremental=!0),a.layout(),e&&(c.centerX=h,c.centerY=p);for(var S=a.initPostProcess(),m=0;m<S.length;m++)a.oneStepPostProcess(S[m]);a.updateNodeAngles(),a.updateNodeCoordinates();for(var A=0;A<g.length;A++){var T=g[A],R=t.get(T),D=R.getLocation();T.setLocation(D.x,D.y),T.getOnCircleNodeExt().setIndex(R.getIndex()),T.getOnCircleNodeExt().setAngle(R.getAngle())}if(g.sort(function(e,t){return e.getOnCircleNodeExt().getIndex()-t.getOnCircleNodeExt().getIndex()}),c.getNodes().length>0){var P=s.getParent(),w=c.getParent();P.setLocation(w.getLocation().x,w.getLocation().y),s.setRadius(c.getRadius()),s.calculateParentNodeDimension()}}}},i.prototype.doStep2=function(){this.step=i.STEP_2,this.phase=i.PHASE_OTHER;for(var e=[],t=[],n=new o,r=new o,s=new c,a=s.newGraphManager(),d=a.addRoot(),l=this.graphManager.getNonOnCircleNodes(),g=0;g<l.length;g++){var h=l[g],u=s.newNode(null),p=h.getLocation();u.setLocation(p.x,p.y),u.setWidth(h.getWidth()),u.setHeight(h.getHeight()),null!=h.getChild()&&(u.setWidth(1.2*u.getWidth()),u.setHeight(1.2*u.getHeight())),u.id=g,d.add(u),e.push(u),n.put(h,u)}for(var f=new Array(e.length),N=0;N<f.length;N++)f[N]=new Array(e.length);for(var E=this.graphManager.getAllEdges(),v=0;v<E.length;v++){var C=E[v],y=C.getSource(),I=C.getTarget();null!=y.getOnCircleNodeExt()&&(y=C.getSource().getOwner().getParent()),null!=I.getOnCircleNodeExt()&&(I=C.getTarget().getOwner().getParent());var O=n.get(y),x=n.get(I),_=e.indexOf(O),S=e.indexOf(x),m=void 0;_!==S&&(null==f[_][S]&&null==f[S][_]?(m=s.newEdge(null),d.add(m,O,x),t.push(m),r.put(m,[]),f[_][S]=m,f[S][_]=m):m=f[_][S],r.get(m).push(C))}s.runLayout();for(var A=0;A<l.length;A++){var T=l[A],R=n.get(T),D=R.getLocation();T.setLocation(D.x,D.y)}for(var P=this.graphManager.getOnCircleNodes(),w=0;w<P.length;w++){var L=P[w],F=L.getLocation(),M=L.getOwner().getParent().getLocation();L.setLocation(F.x+M.x,F.y+M.y)}},i.prototype.step3Init=function(){this.step=i.STEP_3,this.phase=i.PHASE_OTHER,this.initSpringEmbedder(),this.coolingCycle=0},i.prototype.step4Init=function(){this.step=i.STEP_4,this.phase=i.PHASE_OTHER,this.initSpringEmbedder();for(var e=0;e<this.graphManager.getOnCircleNodes().length;e++)this.graphManager.getOnCircleNodes()[e].getOnCircleNodeExt().updateSwappingConditions();this.coolingCycle=0},i.prototype.step5Init=function(){this.step=i.STEP_5,this.phase=i.PHASE_OTHER,this.initSpringEmbedder(),this.coolingCycle=0},i.prototype.runSpringEmbedderTick=function(){if(this.iterations++,this.totalIterations=this.iterations,this.iterations%g.CONVERGENCE_CHECK_PERIOD==0){if((this.step!==i.STEP_4||this.iterations>this.maxIterations/4)&&this.isConverged())return!0;this.coolingFactor=this.initialCoolingFactor*((this.maxIterations-this.iterations)/this.maxIterations)}if(this.totalDisplacement=0,this.step===i.STEP_3)this.iterations%g.REVERSE_PERIOD==0&&this.checkAndReverseIfReverseIsBetter();else if(this.step===i.STEP_4){this.iterations%g.SWAP_HISTORY_CLEARANCE_PERIOD==0&&(this.swappedPairsInLastIteration=[]);var e=this.iterations%g.SWAP_PERIOD;e>=g.SWAP_IDLE_DURATION?this.phase=i.PHASE_SWAP_PREPERATION:this.phase=0===e?i.PHASE_PERFORM_SWAP:i.PHASE_OTHER}return this.calcSpringForces(),this.calcRepulsionForces(),this.calcGravitationalForces(),this.calcTotalForces(),this.moveNodes(),this.iterations>=this.maxIterations},i.prototype.prepareCirclesForReversal=function(){this.graphManager.getRoot().getNodes().forEach(function(e){var t=e.getChild();null!==t&&void 0!==t&&(t.getInterClusterEdges().length<2&&t.setMayNotBeReversed(),t.computeOrderMatrix())})},i.prototype.calcIdealEdgeLengths=function(e){for(var t=this.graphManager.getAllEdges(),n=0;n<t.length;n++){var i=t[n];i.idealLength=e?1.5*this.idealEdgeLength*this.idealInterClusterEdgeLengthCoefficient:this.idealEdgeLength*this.idealInterClusterEdgeLengthCoefficient}for(var r=this.graphManager.getInCircleNodes(),o=0;o<r.length;o++){r[o].getEdges().forEach(function(e){e.idealLength=g.DEFAULT_INNER_EDGE_LENGTH})}},i.prototype.calcSpringForces=function(){for(var e=this.graphManager.getAllEdges(),t=0;t<e.length;t++){var n=e[t],i=n.getSource(),r=n.getTarget();n.isIntraCluster&&null!=i.getOnCircleNodeExt()&&null!=r.getOnCircleNodeExt()||this.calcSpringForce(n,n.idealLength)}},i.prototype.calcRepulsionForces=function(){for(var e=this.graphManager.getNonOnCircleNodes(),t=0;t<e.length;t++)for(var n=e[t],i=t+1;i<e.length;i++){var r=e[i];this.calcRepulsionForce(n,r)}for(var o=this.graphManager.getInCircleNodes(),s=0;s<o.length;s++)for(var a=o[s],d=a.getOwner(),l=d.getNodes(),c=0;c<l.length;c++){var g=l[c];g!==a&&this.calcRepulsionForce(a,g)}},i.prototype.calcGravitationalForces=function(){if(!this.graphManager.rootGraph.isConnected)for(var e=this.graphManager.getNonOnCircleNodes(),t=0;t<e.length;t++){var n=e[t];this.calcGravitationalForce(n)}for(var i=this.graphManager.getInCircleNodes(),r=0;r<i.length;r++){var o=i[r];this.calcGravitationalForce(o)}},i.prototype.calcTotalForces=function(){for(var e=this.graphManager.getAllNodes(),t=0;t<e.length;t++){var n=e[t];n.displacementX=this.coolingFactor*(n.springForceX+n.repulsionForceX+n.gravitationForceX),n.displacementY=this.coolingFactor*(n.springForceY+n.repulsionForceY+n.gravitationForceY),n.rotationAmount=0,n.springForceX=0,n.springForceY=0,n.repulsionForceX=0,n.repulsionForceY=0,n.gravitationForceX=0,n.gravitationForceY=0}for(var r=this.graphManager.getOnCircleNodes(),o=0;o<r.length;o++){var s=r[o],a=s.getOwner().getParent(),d=s.getOwner().decomposeForce(s);this.phase===i.PHASE_SWAP_PREPERATION&&s.getOnCircleNodeExt().addDisplacementForSwap(d.getRotationAmount()),a.displacementX+=d.getDisplacementX(),a.displacementY+=d.getDisplacementY(),s.displacementX=0,s.displacementY=0,a.rotationAmount+=d.getRotationAmount(),s.rotationAmount=0}},i.prototype.moveNodes=function(){if(this.phase!==i.PHASE_PERFORM_SWAP){for(var e=this.graphManager.getNonOnCircleNodes(),t=0;t<e.length;t++)e[t].move(),null!==e[t].getChild()&&void 0!==e[t].getChild()&&e[t].getChild().rotate();for(var n=this.graphManager.getInCircleNodes(),r=void 0,o=0;o<n.length;o++)r=n[o],r.displacementX/=20,r.displacementY/=20,r.move()}else{for(var s=this.graphManager.getOnCircleNodes(),a=s.length,d=[],l=[],c=[],h=[],u=void 0,p=void 0,f=void 0,E=void 0,v=void 0,C=void 0,y=void 0,I=void 0,O=0;O<a;O++)if(u=s[O],p=u.getOnCircleNodeExt().getNextNode(),f=u.getOnCircleNodeExt(),E=p.getOnCircleNodeExt(),f.canSwapWithNext&&E.canSwapWithPrev&&(v=f.getDisplacementForSwap(),C=E.getDisplacementForSwap(),!((y=v-C)<0))){I=v>0&&C>0||v<0&&C<0;var x=new N(u,p,y,I);0===v||0===C?l.push(x):d.push(x)}var _=void 0,S=!0,m=void 0;for(d.sort(function(e,t){return e.getDiscrepancy()-t.getDiscrepancy()});S&&d.length>0;)if(_=d[d.length-1],u=_.getFirstNode(),p=_.getSecondNode(),f=u.getOnCircleNodeExt(),E=p.getOnCircleNodeExt(),this.isSwappedPreviously(_))d.pop(),h.push(_);else{var A=f.getInterClusterIntersections(E);_.swap(),m=!1;var T=f.getInterClusterIntersections(E);m=T>A,m||T!==A||(m=_.inSameDirection()||_.getDiscrepancy()<g.MIN_DISPLACEMENT_FOR_SWAP),m?(_.swap(),d.pop()):(c.push(_.getFirstNode()),c.push(_.getSecondNode()),h.push(_),S=!1)}for(var R=0;R<l.length;R++){var D=l[R];D.inSameDirection()||D.getDiscrepancy()<g.MIN_DISPLACEMENT_FOR_SWAP||(c.includes(D.getFirstNode())||c.includes(D.getSecondNode())||(this.isSwappedPreviously(D)||(D.swap(),c.push(D.getFirstNode()),c.push(D.getSecondNode())),h.push(D)))}this.swappedPairsInLastIteration=[];for(var P=0;P<h.length;P++)this.swappedPairsInLastIteration.push(h[P]);for(var w=void 0,L=0;L<a;L++)w=s[L],w.getOnCircleNodeExt().setDisplacementForSwap(0)}},i.prototype.isSwappedPreviously=function(e){for(var t=0;t<this.swappedPairsInLastIteration.length;t++){var n=this.swappedPairsInLastIteration[t];if(n.getFirstNode()===e.getFirstNode()&&n.getSecondNode()===e.getSecondNode()||n.getSecondNode()===e.getFirstNode()&&n.getFirstNode()===e.getSecondNode())return!0}return!1},i.prototype.checkAndReverseIfReverseIsBetter=function(){for(var e=this.getGraphManager(),t=e.getRoot().getNodes(),n=void 0,i=void 0,r=0;r<t.length;r++)if(n=t[r],null!=(i=n.getChild())&&i.getMayBeReversed()&&i.getNodes().length<=52&&i.checkAndReverseIfReverseIsBetter())return!0;return!1},i.prototype.findAndMoveInnerNodes=function(){if(this.allowNodesInsideCircle)for(var e=this.graphManager.getGraphs(),t=0;t<e.length;t++){var n=e[t],i=0;if(n!==this.getGraphManager().getRoot())for(var r=Math.floor(n.getNodes().length*this.maxRatioOfNodesInsideCircle),o=this.findInnerNode(n);null!==o&&void 0!==o&&i<r;)this.moveInnerNode(o),++i<r&&(o=this.findInnerNode(n))}},i.prototype.findInnerNode=function(e){var t=null,n=e.getOnCircleNodes().length,i=e.getOnCircleNodes();i.sort(function(e,t){return e.getEdges().length-t.getEdges().length});for(var r=n-1;r>=0&&null==t;r--){var o=i[r];if(0===o.getOnCircleNodeExt().getInterClusterEdges().length){var s=this.findMinimalSpanningSegment(o);if(0!==s.length){for(var a=!1,d=0;d<s.length;d++){var l=s[d];if(a)break;for(var c=l.getNeighborsList(),g=0;g<c.length;g++){var h=c[g];if(h!==o&&h.getOwner()===e&&null!=h.getOnCircleNodeExt()&&void 0!=h.getOnCircleNodeExt()){var u=l.getOnCircleNodeExt().getIndex(),p=h.getOnCircleNodeExt().getIndex(),f=u-p;if(f+=n,f%=n,f>1&&(f=p-u,f+=n,f%=n),f>1){a=!0;break}}}}a||(t=o)}}}return t},i.prototype.moveInnerNode=function(e){e.getOwner().moveOnCircleNodeInside(e);var t=this.graphManager.getOnCircleNodes(),n=t.indexOf(e);n>-1&&t.splice(n,1),this.graphManager.inCircleNodes.push(e)},i.prototype.findMinimalSpanningSegment=function(e){var t=[],n=e.getOnCircleNeighbors();if(0===n.length)return t;n.sort(function(e,t){return e.getOnCircleNodeExt().getIndex()-t.getOnCircleNodeExt().getIndex()});var i=e.getOwner().getOnCircleNodes();i.sort(function(e,t){return e.getOnCircleNodeExt().getIndex()-t.getOnCircleNodeExt().getIndex()});var r=null,o=null,s=i.length,a=i.length,d=n.length,l=void 0,c=void 0,g=void 0,h=void 0,u=void 0;for(l=0;l<d;l++)c=(l-1+d)%d,g=n[l],h=n[c],(u=(h.getOnCircleNodeExt().getIndex()-g.getOnCircleNodeExt().getIndex()+a)%a+1)<s&&(r=g,o=h,s=u);for(var p=!1,f=r;!p;)if(f!==e&&t.push(f),f===o)p=!0;else{var N=f.getOnCircleNodeExt().getIndex()+1;N===i.length&&(N=0),f=i[N]}return t},e.exports=i},function(e,t,n){"use strict";function i(e,t,n,i){r.call(this,e,t,n,i),this.rotationAmount=null,this.onCircleNodeExt=null,this.clusterID=null,this.ID=null}var r=n(0).layoutBase.FDLayoutNode,o=n(0).layoutBase.IMath,s=n(1),a=n(11);i.prototype=Object.create(r.prototype);for(var d in r)i[d]=r[d];i.prototype.setClusterId=function(e){this.clusterID=e},i.prototype.getClusterId=function(){return this.clusterID},i.prototype.setId=function(e){this.ID=e},i.prototype.getId=function(){return this.ID},i.prototype.setAsOnCircleNode=function(){return this.onCircleNodeExt=new a(this),this.onCircleNodeExt},i.prototype.setAsNonOnCircleNode=function(){this.onCircleNodeExt=null},i.prototype.getOnCircleNodeExt=function(){return this.onCircleNodeExt},i.prototype.getLimitedDisplacement=function(e){return Math.abs(e)>s.MAX_NODE_DISPLACEMENT&&(e=s.MAX_NODE_DISPLACEMENT*o.sign(e)),e},i.prototype.getOnCircleNeighbors=function(){for(var e=Array.from(this.getNeighborsList()),t=[],n=0;n<e.length;n++){var i=e[n];null!==i.getOnCircleNodeExt()&&i.getClusterId()===this.getClusterId()&&t.push(i)}return t},i.prototype.getNoOfChildren=function(){return null===this.getChild()||void 0===this.getChild()?1:this.getChild().getNodes().length},i.prototype.move=function(){var e=this.getOwner().getGraphManager().getLayout();if(this.displacementX=this.getLimitedDisplacement(this.displacementX),this.displacementY=this.getLimitedDisplacement(this.displacementY),null!==this.getChild()&&void 0!==this.getChild()){var t=this.getChild().getNodes().length;this.displacementX/=t,this.displacementY/=t;for(var n=this.getChild().getNodes(),i=0;i<n.length;i++){n[i].moveBy(this.displacementX,this.displacementY),e.totalDisplacement+=Math.abs(this.displacementX)+Math.abs(this.displacementY)}}this.moveBy(this.displacementX,this.displacementY),e.totalDisplacement+=Math.abs(this.displacementX)+Math.abs(this.displacementY),null!==this.getChild()&&void 0!==this.getChild()&&this.getChild().updateBounds(!0)},i.prototype.reset=function(){this.displacementX=0,this.displacementY=0},e.exports=i},function(e,t,n){"use strict";function i(e){this.ciseNode=e,this.intraClusterEdges=null,this.interClusterEdges=null,this.angle=-1,this.orderIndex=-1,this.canSwapWithNext=null,this.canSwapWithPrevious=null,this.displacementForSwap=null}var r=n(0).layoutBase.IGeometry;i.prototype=Object.create(null),i.prototype.getCiseNode=function(){return this.ciseNode},i.prototype.getAngle=function(){return this.angle},i.prototype.setAngle=function(e){this.angle=e%r.TWO_PI,this.angle<0&&(this.angle+=r.TWO_PI)},i.prototype.getIndex=function(){return this.orderIndex},i.prototype.setIndex=function(e){this.orderIndex=e},i.prototype.getCharCode=function(){return this.orderIndex<26?String.fromCharCode(97+this.orderIndex):this.orderIndex<52?String.fromCharCode(65+this.orderIndex):"?"},i.prototype.getNextNode=function(){var e=this.ciseNode.getOwner(),t=e.getOnCircleNodes().length,n=this.orderIndex+1;return n===t&&(n=0),e.getOnCircleNodes()[n]},i.prototype.getPrevNode=function(){var e=this.ciseNode.getOwner(),t=this.orderIndex-1;return-1===t&&(t=e.getOnCircleNodes().length-1),e.getOnCircleNodes()[t]},i.prototype.getNextNodeExt=function(){return this.getNextNode().getOnCircleNodeExt()},i.prototype.prevNextNodeExt=function(){return this.getPrevNode().getOnCircleNodeExt()},i.prototype.canSwapWithNext=function(){return this.canSwapWithNext},i.prototype.canSwapWithPrev=function(){return this.canSwapWithPrev},i.prototype.getDisplacementForSwap=function(){return this.displacementForSwap},i.prototype.setDisplacementForSwap=function(e){this.displacementForSwap=e},i.prototype.addDisplacementForSwap=function(e){this.displacementForSwap=e},i.prototype.updatePosition=function(){var e=this.ciseNode.getOwner(),t=e.getParent(),n=t.getCenterX(),i=t.getCenterY(),r=e.getRadius()*Math.cos(this.angle),o=e.getRadius()*Math.sin(this.angle);this.ciseNode.setCenter(n+r,i+o)},i.prototype.getCircDistWithTheNode=function(e){var t=e.getIndex();if(-1===t||-1===this.getIndex())return-1;var n=this.getIndex()-t;return n<0&&(n+=this.ciseNode.getOwner().getOnCircleNodes().length),n},i.prototype.calculateTotalCrossing=function(){var e=this.getIntraClusterEdges(),t=0,n=[];return this.ciseNode.getOwner().getIntraClusterEdges().forEach(function(e){n.push(e)}),this.ciseNode.getEdges().forEach(function(e){var t=n.indexOf(e);t>-1&&n.splice(t,1)}),e.forEach(function(e){t+=e.calculateTotalCrossingWithList(n)}),t},i.prototype.updateSwappingConditions=function(){var e=this.calculateTotalCrossing(),t=this.orderIndex,n=this.getNextNode().getOnCircleNodeExt();this.orderIndex=n.getIndex(),n.setIndex(t);var i=this.calculateTotalCrossing();this.canSwapWithNext=i<=e,n.setIndex(this.orderIndex),this.setIndex(t);var r=this.getPrevNode().getOnCircleNodeExt();this.orderIndex=r.getIndex(),r.setIndex(t),i=this.calculateTotalCrossing(),this.canSwapWithPrevious=i<=e,r.setIndex(this.orderIndex),this.setIndex(t)},i.prototype.swapWith=function(e){this.ciseNode.getOwner().swapNodes(this.ciseNode,e.ciseNode)},i.prototype.getInterClusterIntersections=function(e){for(var t=0,n=this.getInterClusterEdges(),i=e.getInterClusterEdges(),o=0;o<n.length;o++)for(var s=n[o],a=this.ciseNode.getCenter(),d=s.getOtherEnd(this.ciseNode).getCenter(),l=0;l<i.length;l++){var c=i[l],g=e.ciseNode.getCenter(),h=c.getOtherEnd(e.ciseNode).getCenter();if(s.getOtherEnd(this.ciseNode)!==c.getOtherEnd(e.ciseNode)){var u=r.doIntersect(a,d,g,h);u&&t++}}return t},i.prototype.getInterClusterEdges=function(){if(null===this.interClusterEdges){this.interClusterEdges=[];for(var e=this.ciseNode.getEdges(),t=0;t<e.length;t++){var n=e[t];n.isIntraCluster||this.interClusterEdges.push(n)}}return this.interClusterEdges},i.prototype.getIntraClusterEdges=function(){if(null===this.intraClusterEdges){this.intraClusterEdges=[];for(var e=this.ciseNode.getEdges(),t=0;t<e.length;t++){var n=e[t];n.isIntraCluster&&this.intraClusterEdges.push(n)}}return this.intraClusterEdges},e.exports=i},function(e,t,n){"use strict";function i(e,t,n,i){this.firstNode=e,this.secondNode=t,this.discrepancy=n,this.inSameDir=i}i.prototype=Object.create,i.prototype.getDiscrepancy=function(){return this.discrepancy},i.prototype.inSameDirection=function(){return this.inSameDir},i.prototype.getFirstNode=function(){return this.firstNode},i.prototype.getSecondNode=function(){return this.secondNode},i.prototype.compareTo=function(e){return this.getDiscrepancy()-e.getDiscrepancy()},i.prototype.swap=function(){this.getFirstNode().getOnCircleNodeExt().swapWith(this.getSecondNode().getOnCircleNodeExt())},i.prototype.equals=function(e){var t=e instanceof i;if(t){var n=e;t&=this.firstNode.equals(n.getFirstNode())&&this.secondNode.equals(n.getSecondNode())||this.secondNode.equals(n.getFirstNode())&&this.firstNode.equals(n.getSecondNode())}return t},i.prototype.hashCode=function(){return this.firstNode.hashCode()+this.secondNode.hashCode()},i.prototype.toString=function(){var e="Swap: "+this.getFirstNode().label;return e+="<->"+this.getSecondNode().label,e+=", "+this.getDiscrepancy()},e.exports=i},function(e,t,n){"use strict";function i(e,t,n){this.rotationAmount=e,this.displacementX=t,this.displacementY=n}i.prototype.getRotationAmount=function(){return this.rotationAmount},i.prototype.setRotationAmount=function(e){this.rotationAmount=e},i.prototype.getDisplacementX=function(){return this.displacementX},i.prototype.setDisplacementX=function(e){this.displacementX=e},i.prototype.getDisplacementY=function(){return this.displacementY},i.prototype.setDisplacementY=function(e){this.displacementY=e},e.exports=i},function(e,t,n){"use strict";var i=n(3),r=function(e){e&&e("layout","cise",i)};"undefined"!=typeof cytoscape&&r(cytoscape),e.exports=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(i)},d=n(9),l=n(1),c=n(0).layoutBase.FDLayoutConstants,g=n(17),h=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return null!==e.nodeSeparation&&void 0!==e.nodeSeparation?l.DEFAULT_NODE_SEPARATION=e.nodeSeparation:l.DEFAULT_NODE_SEPARATION=c.DEFAULT_EDGE_LENGTH/4,null!==e.idealInterClusterEdgeLengthCoefficient&&void 0!==e.idealInterClusterEdgeLengthCoefficient?l.DEFAULT_IDEAL_INTER_CLUSTER_EDGE_LENGTH_COEFF=e.idealInterClusterEdgeLengthCoefficient:l.DEFAULT_IDEAL_INTER_CLUSTER_EDGE_LENGTH_COEFF=1.4,null!==e.allowNodesInsideCircle&&void 0!==e.allowNodesInsideCircle?l.DEFAULT_ALLOW_NODES_INSIDE_CIRCLE=e.allowNodesInsideCircle:l.DEFAULT_ALLOW_NODES_INSIDE_CIRCLE=!1,null!==e.maxRatioOfNodesInsideCircle&&void 0!==e.maxRatioOfNodesInsideCircle?l.DEFAULT_MAX_RATIO_OF_NODES_INSIDE_CIRCLE=e.maxRatioOfNodesInsideCircle:l.DEFAULT_MAX_RATIO_OF_NODES_INSIDE_CIRCLE=.1,null!==e.springCoeff&&void 0!==e.springCoeff?l.DEFAULT_SPRING_STRENGTH=e.springCoeff:l.DEFAULT_SPRING_STRENGTH=1.5*c.DEFAULT_SPRING_STRENGTH,null!=e.nodeRepulsion&&(l.DEFAULT_REPULSION_STRENGTH=c.DEFAULT_REPULSION_STRENGTH=e.nodeRepulsion),null!=e.gravity&&(l.DEFAULT_GRAVITY_STRENGTH=c.DEFAULT_GRAVITY_STRENGTH=e.gravity),null!=e.gravityRange&&(l.DEFAULT_GRAVITY_RANGE_FACTOR=c.DEFAULT_GRAVITY_RANGE_FACTOR=e.gravityRange),null!==e.maxRatioOfNodesInsideCircle&&void 0!==e.maxRatioOfNodesInsideCircle?l.DEFAULT_MAX_RATIO_OF_NODES_INSIDE_CIRCLE=e.maxRatioOfNodesInsideCircle:l.DEFAULT_MAX_RATIO_OF_NODES_INSIDE_CIRCLE=.1,n}return o(t,e),s(t,[{key:"prerun",value:function(e){var t=[[]];if(null===e.clusters||void 0===e.clusters)throw"ERROR: Cluster information is invalid/undefined/null. Please create the 'clusters' variable as defined in the documentation";t=e.clusters;var n=void 0;if(!(null!==e.nodes&&void 0!==e.nodes||e.nodes.length>0))throw"ERROR: Node information is invalid/undefined/null or simply empty. Please make sure nodes are passed properly. Can't layout an empty graph";n=e.nodes;var i=e.edges,r=this.ciseLayout=new d,o=this.graphManager=r.newGraphManager(),s=this.root=o.addRoot();this.idToLNode=r.convertToClusteredGraph(n,i,t),s.updateConnected(),s.calcEstimatedSize(),r.calcNoOfChildrenForAllNodes(),r.doStep1(!this.options.randomize),this.options.randomize&&r.doStep2(),s.updateBounds(!0),s.estimatedSize=Math.max(s.right-s.left,s.bottom-s.top),r.prepareCirclesForReversal(),r.calcIdealEdgeLengths(!1),this.initializerIndex=0,this.isDone=!1,this.isStepDone=!1,this.timeToSwitchNextStep=!0}},{key:"tick",value:function(e){var t=this,n=this;if(e.nodes.forEach(function(i){var r=t.getScratch(i,e.name),o=n.idToLNode[i.data("id")];r.x=o.getCenterX(),r.y=o.getCenterY()}),this.timeToSwitchNextStep){switch(this.initializerIndex){case 0:this.ciseLayout.step5Init();break;case 1:this.options.randomize&&this.ciseLayout.step3Init();break;case 2:this.ciseLayout.step5Init();break;case 3:this.ciseLayout.step4Init();break;case 4:this.ciseLayout.findAndMoveInnerNodes(),this.ciseLayout.calcIdealEdgeLengths(!0),this.ciseLayout.step5Init()}this.initializerIndex++,this.ciseLayout.iterations=0,this.ciseLayout.totalDisplacement=1e3,this.timeToSwitchNextStep=!1}return this.isStepDone=this.ciseLayout.runSpringEmbedderTick(),this.isStepDone&&this.initializerIndex<5&&(this.timeToSwitchNextStep=!0),this.isStepDone&&!1===this.timeToSwitchNextStep&&(this.isDone=!0),this.isDone}},{key:"postrun",value:function(){}},{key:"destroy",value:function(){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this}}]),t}(g);e.exports=h},function(e,t,n){"use strict";e.exports=Object.freeze({animate:!1,refresh:10,maxIterations:2500,maxSimulationTime:5e3,ungrabifyWhileSimulating:!1,fit:!0,padding:30,boundingBox:void 0,ready:function(){},stop:function(){},randomize:!0,infinite:!1,packComponents:!1})},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(2),s=n(16),a=n(18),d=n(19),l=d.setInitialPositionState,c=d.refreshPositions,g=d.getNodePositionData,h=n(20),u=h.multitick,p=function(){function e(t){i(this,e);var n=this.options=o({},s,t),r=this.state=o({},n,{layout:this,nodes:n.eles.nodes(),edges:n.eles.edges(),tickIndex:0,firstUpdate:!0});if(r.animateEnd=n.animate&&"end"===n.animate,r.animateContinuously=n.animate&&!r.animateEnd,n.packComponents){if(null==this.state.clusters||void 0==this.state.clusters)throw"ERROR: Cluster information is invalid/undefined/null. Please create the 'clusters' variable as defined in the documentation";if(null==this.state.nodes&&void 0==this.state.nodes||0==this.state.nodes.length)throw"ERROR: Node information is invalid/undefined/null or simply empty. Please make sure nodes are passed properly. Can't layout an empty graph";this.states=[];var a=n.cy.$().components();a=this.mergeComponentsIfNeeded(a,this.state.clusters);for(var d=0;d<a.length;d++){var l=a[d],c=o({},n,{layout:this,nodes:l.nodes(),edges:l.edges(),tickIndex:0,firstUpdate:!0});c.animateEnd=n.animate&&"end"===n.animate,c.animateContinuously=n.animate&&!c.animateEnd,c.clusters=this.getRelevantClusters4Nodes(c.clusters,c.nodes),this.states.push(c)}}}return r(e,[{key:"mergeComponentsIfNeeded",value:function(e,t){var n={};if("function"==typeof t){for(var i={},r=0;r<e.length;r++){i[r]={};for(var o=0;o<e[r].length;o++){var s=t(e[r][o]);i[r][s]=!0}}for(var a in i)for(var d in i[a])if(n[d])n[d][a]=!0;else{var l={};l[a]=!0,n[d]=l}}else for(var c=0;c<t.length;c++)!function(i){for(var r=0;r<t[i].length;r++)!function(r){var o=e.findIndex(function(e){return e.$id(t[i][r]).length>0});if(n[i])n[i][o]=!0;else{var s={};s[o]=!0,n[i]=s}}(r)}(c);var g=[],h={};for(var u in n){var p=Object.keys(n[u]);if(!(p.length<2)){for(var f=this.options.cy.collection(),N=0;N<p.length;N++)h[p[N]]||(f=f.union(e[p[N]]),h[p[N]]=!0);f.length>0&&g.push(f)}}for(var E=0;E<e.length;E++)h[E]||g.push(e[E]);return g}},{key:"getRelevantClusters4Nodes",value:function(e,t){for(var n={},i=0;i<t.length;i++)n[t[i].id()]=!0;var r=[];if("function"==typeof e){for(var o={},s=0;s<t.length;s++){var a=t[s].id(),d=e(t[s]);o[d]?o[d].push(a):o[d]=[a]}r=Object.values(o)}else for(var l=0;l<e.length;l++){for(var c=[],g=0;g<e[l].length;g++){var h=e[l][g];n[h]&&c.push(h)}c.length>0&&r.push(c)}return r}},{key:"getScratch",value:function(e,t){var n=e.scratch(t);return n||(n={},e.scratch(t,n)),n}},{key:"run4state",value:function(e){var t=this;e.tickIndex=0,e.firstUpdate=!0,e.startTime=Date.now(),e.running=!0,e.currentBoundingBox=a(e.boundingBox,e.cy),e.ready&&t.one("ready",e.ready),e.stop&&t.one("stop",e.stop);for(var n=0;n<e.nodes.length;n++)l(e.nodes[n],e);if(this.prerun(e),e.animateContinuously){var i=function(t){if(e.ungrabifyWhileSimulating){(g(t,e).grabbable=t.grabbable())&&t.ungrabify()}},r=function(t){if(e.ungrabifyWhileSimulating){g(t,e).grabbable&&t.grabify()}},o=function(t){return g(t,e).grabbed=t.grabbed()},s=function(e){var t=e.target;o(t)},d=s,h=function(t){var n=t.target,i=g(n,e),r=n.position();i.x=r.x,i.y=r.y},p=function(e){e.on("grab",s),e.on("free",d),e.on("drag",h)},f=function(e){e.removeListener("grab",s),e.removeListener("free",d),e.removeListener("drag",h)},N=function(){e.fit&&e.animateContinuously&&e.cy.fit(e.padding)},E=function(){c(e.nodes,e),N(),requestAnimationFrame(v)},v=function(){u(e,E,C)},C=function(){c(e.nodes,e),N(),e.nodes.forEach(function(e){r(e),f(e)}),e.running=!1,t.emit("layoutstop")};t.emit("layoutstart"),e.nodes.forEach(function(e){i(e),p(e)}),v()}else{for(var y=!1,I=function(){},O=function(){return y=!0};!y;)u(e,I,O);this.states||e.nodes.layoutPositions(this,e,function(t){var n=g(t,e);return{x:n.x,y:n.y}})}return t.postrun(e),this}},{key:"run",value:function(){if(this.states){for(var e=0;e<this.states.length;e++)this.run4state(this.states[e]);this.setShifts4PackingComponents(this.states)}else this.run4state(this.state)}},{key:"stop",value:function(){return this.state.running=!1,this}},{key:"destroy",value:function(){return this}},{key:"setShifts4PackingComponents",value:function(e){var t=this.options.cy;if(!t.layoutUtilities||!this.options.packComponents)return null;for(var n=[],i=0;i<e.length;i++){for(var r=[],o=0;o<e[i].nodes.length;o++){var s=e[i].nodes[o],a=g(s,e[i]),d=s.boundingBox();r.push({x:a.x,y:a.y,width:d.w,height:d.h})}for(var l=[],c=0;c<e[i].edges.length;c++){var h=e[i].edges[c],u=h.sourceEndpoint(),p=h.targetEndpoint();l.push({startX:u.x,startY:u.y,endX:p.x,endY:p.y})}n.push({nodes:r,edges:l})}var f=t.layoutUtilities("get");f||(f=t.layoutUtilities({desiredAspectRatio:t.width()/t.height()}));for(var N=f.packComponents(n).shifts,E={},v=0;v<e.length;v++)for(var C=0;C<e[v].nodes.length;C++)E[e[v].nodes[C].id()]={x:N[v].dx,y:N[v].dy};e[0].eles.layoutPositions(this,e[0],function(t){var n=g(t,e[0]),i=t.id();return{x:n.x+E[i].x,y:n.y+E[i].y}})}}]),e}();e.exports=p},function(e,t,n){"use strict";e.exports=function(e,t){return e=null==e?{x1:0,y1:0,w:t.width(),h:t.height()}:{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,w:e.w,h:e.h},null==e.x2&&(e.x2=e.x1+e.w),null==e.w&&(e.w=e.x2-e.x1),null==e.y2&&(e.y2=e.y1+e.h),null==e.h&&(e.h=e.y2-e.y1),e}},function(e,t,n){"use strict";var i=n(2),r=function(e,t){var n=e.position(),r=t.currentBoundingBox,o=e.scratch(t.name);null==o&&(o={},e.scratch(t.name,o)),i(o,t.randomize?{x:r.x1+Math.round(Math.random()*r.w),y:r.y1+Math.round(Math.random()*r.h)}:{x:n.x,y:n.y}),o.locked=e.locked()},o=function(e,t){return e.scratch(t.name)},s=function(e,t){e.positions(function(e){var n=e.scratch(t.name);return{x:n.x,y:n.y}})};e.exports={setInitialPositionState:r,getNodePositionData:o,refreshPositions:s}},function(e,t,n){"use strict";var i=function(){},r=function(e){var t=e,n=e.layout,i=n.tick(t);return t.firstUpdate&&(t.animateContinuously&&t.layout.emit("layoutready"),t.firstUpdate=!1),t.tickIndex++,!t.infinite&&i},o=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,o=!1,s=e,a=0;a<s.refresh&&!(o=!s.running||r(s));a++);o?n():t()};e.exports={tick:r,multitick:o}},function(e,n){e.exports=t}])});